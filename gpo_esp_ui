-- GPO ESP UI Script
-- Legendary & Mythical Chest ESP Toggle

local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local UserInputService = game:GetService("UserInputService")

local player = Players.LocalPlayer
local playerGui = player:WaitForChild("PlayerGui")

-- Configuration
local espConfig = {
    legendaryESP = false,
    mythicalESP = false,
    updateRate = 0.1
}

-- Create Main UI Container
local screenGui = Instance.new("ScreenGui")
screenGui.Name = "GPOEspUI"
screenGui.ResetOnSpawn = false
screenGui.Parent = playerGui

-- Main Panel
local mainPanel = Instance.new("Frame")
mainPanel.Name = "MainPanel"
mainPanel.Size = UDim2.new(0, 320, 0, 180)
mainPanel.Position = UDim2.new(0, 20, 0, 20)
mainPanel.BackgroundColor3 = Color3.fromRGB(20, 20, 25)
mainPanel.BorderSizePixel = 0
mainPanel.Parent = screenGui

-- Add Corner Radius
local corner = Instance.new("UICorner")
corner.CornerRadius = UDim.new(0, 12)
corner.Parent = mainPanel

-- Add Shadow
local shadow = Instance.new("Frame")
shadow.Name = "Shadow"
shadow.Size = UDim2.new(1, 8, 1, 8)
shadow.Position = UDim2.new(0, -4, 0, -4)
shadow.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
shadow.BorderSizePixel = 0
shadow.Parent = mainPanel
shadow.ZIndex = mainPanel.ZIndex - 1

local shadowCorner = Instance.new("UICorner")
shadowCorner.CornerRadius = UDim.new(0, 12)
shadowCorner.Parent = shadow

-- Header
local header = Instance.new("Frame")
header.Name = "Header"
header.Size = UDim2.new(1, 0, 0, 50)
header.BackgroundColor3 = Color3.fromRGB(100, 50, 200)
header.BorderSizePixel = 0
header.Parent = mainPanel

local headerCorner = Instance.new("UICorner")
headerCorner.CornerRadius = UDim.new(0, 12)
headerCorner.Parent = header

-- Header Title
local headerTitle = Instance.new("TextLabel")
headerTitle.Name = "Title"
headerTitle.Size = UDim2.new(1, -40, 1, 0)
headerTitle.Position = UDim2.new(0, 10, 0, 0)
headerTitle.BackgroundTransparency = 1
headerTitle.TextColor3 = Color3.fromRGB(255, 255, 255)
headerTitle.TextSize = 18
headerTitle.Font = Enum.Font.GothamBold
headerTitle.TextXAlignment = Enum.TextXAlignment.Left
headerTitle.Text = "GPO Chest ESP"
headerTitle.Parent = header

-- Close Button
local closeBtn = Instance.new("TextButton")
closeBtn.Name = "CloseBtn"
closeBtn.Size = UDim2.new(0, 30, 0, 30)
closeBtn.Position = UDim2.new(1, -35, 0, 10)
closeBtn.BackgroundColor3 = Color3.fromRGB(255, 80, 80)
closeBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
closeBtn.TextSize = 20
closeBtn.Font = Enum.Font.GothamBold
closeBtn.Text = "×"
closeBtn.BorderSizePixel = 0
closeBtn.Parent = header

local closeBtnCorner = Instance.new("UICorner")
closeBtnCorner.CornerRadius = UDim.new(0, 6)
closeBtnCorner.Parent = closeBtn

closeBtn.MouseButton1Click:Connect(function()
    screenGui:Destroy()
end)

-- Legendary Chest Toggle
local legendaryContainer = Instance.new("Frame")
legendaryContainer.Name = "LegendaryContainer"
legendaryContainer.Size = UDim2.new(1, -20, 0, 50)
legendaryContainer.Position = UDim2.new(0, 10, 0, 55)
legendaryContainer.BackgroundColor3 = Color3.fromRGB(30, 30, 35)
legendaryContainer.BorderSizePixel = 0
legendaryContainer.Parent = mainPanel

local legendaryCorner = Instance.new("UICorner")
legendaryCorner.CornerRadius = UDim.new(0, 8)
legendaryCorner.Parent = legendaryContainer

local legendaryLabel = Instance.new("TextLabel")
legendaryLabel.Name = "Label"
legendaryLabel.Size = UDim2.new(0, 200, 1, 0)
legendaryLabel.BackgroundTransparency = 1
legendaryLabel.TextColor3 = Color3.fromRGB(255, 200, 0)
legendaryLabel.TextSize = 16
legendaryLabel.Font = Enum.Font.Gotham
legendaryLabel.TextXAlignment = Enum.TextXAlignment.Left
legendaryLabel.Text = "Legendary Chest ESP"
legendaryLabel.Parent = legendaryContainer

local legendaryToggle = Instance.new("TextButton")
legendaryToggle.Name = "Toggle"
legendaryToggle.Size = UDim2.new(0, 50, 0, 30)
legendaryToggle.Position = UDim2.new(1, -55, 0.5, -15)
legendaryToggle.BackgroundColor3 = Color3.fromRGB(50, 50, 60)
legendaryToggle.TextColor3 = Color3.fromRGB(255, 255, 255)
legendaryToggle.TextSize = 12
legendaryToggle.Font = Enum.Font.GothamBold
legendaryToggle.Text = "OFF"
legendaryToggle.BorderSizePixel = 0
legendaryToggle.Parent = legendaryContainer

local legendaryToggleCorner = Instance.new("UICorner")
legendaryToggleCorner.CornerRadius = UDim.new(0, 6)
legendaryToggleCorner.Parent = legendaryToggle

legendaryToggle.MouseButton1Click:Connect(function()
    espConfig.legendaryESP = not espConfig.legendaryESP
    legendaryToggle.BackgroundColor3 = espConfig.legendaryESP and Color3.fromRGB(0, 200, 100) or Color3.fromRGB(50, 50, 60)
    legendaryToggle.Text = espConfig.legendaryESP and "ON" or "OFF"
end)

-- Mythical Chest Toggle
local mythicalContainer = Instance.new("Frame")
mythicalContainer.Name = "MythicalContainer"
mythicalContainer.Size = UDim2.new(1, -20, 0, 50)
mythicalContainer.Position = UDim2.new(0, 10, 0, 110)
mythicalContainer.BackgroundColor3 = Color3.fromRGB(30, 30, 35)
mythicalContainer.BorderSizePixel = 0
mythicalContainer.Parent = mainPanel

local mythicalCorner = Instance.new("UICorner")
mythicalCorner.CornerRadius = UDim.new(0, 8)
mythicalCorner.Parent = mythicalContainer

local mythicalLabel = Instance.new("TextLabel")
mythicalLabel.Name = "Label"
mythicalLabel.Size = UDim2.new(0, 200, 1, 0)
mythicalLabel.BackgroundTransparency = 1
mythicalLabel.TextColor3 = Color3.fromRGB(255, 0, 255)
mythicalLabel.TextSize = 16
mythicalLabel.Font = Enum.Font.Gotham
mythicalLabel.TextXAlignment = Enum.TextXAlignment.Left
mythicalLabel.Text = "Mythical Chest ESP"
mythicalLabel.Parent = mythicalContainer

local mythicalToggle = Instance.new("TextButton")
mythicalToggle.Name = "Toggle"
mythicalToggle.Size = UDim2.new(0, 50, 0, 30)
mythicalToggle.Position = UDim2.new(1, -55, 0.5, -15)
mythicalToggle.BackgroundColor3 = Color3.fromRGB(50, 50, 60)
mythicalToggle.TextColor3 = Color3.fromRGB(255, 255, 255)
mythicalToggle.TextSize = 12
mythicalToggle.Font = Enum.Font.GothamBold
mythicalToggle.Text = "OFF"
mythicalToggle.BorderSizePixel = 0
mythicalToggle.Parent = mythicalContainer

local mythicalToggleCorner = Instance.new("UICorner")
mythicalToggleCorner.CornerRadius = UDim.new(0, 6)
mythicalToggleCorner.Parent = mythicalToggle

mythicalToggle.MouseButton1Click:Connect(function()
    espConfig.mythicalESP = not espConfig.mythicalESP
    mythicalToggle.BackgroundColor3 = espConfig.mythicalESP and Color3.fromRGB(0, 200, 100) or Color3.fromRGB(50, 50, 60)
    mythicalToggle.Text = espConfig.mythicalESP and "ON" or "OFF"
end)

-- Draggable functionality
local dragging = false
local dragInput
local dragStart
local startPos

mainPanel.InputBegan:Connect(function(input, gameProcessed)
    if gameProcessed then return end
    if input.UserInputType == Enum.UserInputType.MouseButton1 then
        dragging = true
        dragStart = input.Position
        startPos = mainPanel.Position
    end
end)

UserInputService.InputChanged:Connect(function(input, gameProcessed)
    if dragging and input.UserInputType == Enum.UserInputType.MouseMovement then
        local delta = input.Position - dragStart
        mainPanel.Position = startPos + UDim2.new(0, delta.X, 0, delta.Y)
    end
end)

UserInputService.InputEnded:Connect(function(input, gameProcessed)
    if input.UserInputType == Enum.UserInputType.MouseButton1 then
        dragging = false
    end
end)

-- ESP Function
local function createESP(chest)
    if chest:FindFirstChild("ESPLabel") then return end
    
    local billboardGui = Instance.new("BillboardGui")
    billboardGui.Name = "ESPLabel"
    billboardGui.Size = UDim2.new(4, 0, 2, 0)
    billboardGui.MaxDistance = 500
    billboardGui.Parent = chest

    local textLabel = Instance.new("TextLabel")
    textLabel.BackgroundTransparency = 1
    textLabel.TextScaled = true
    textLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
    textLabel.Font = Enum.Font.GothamBold
    textLabel.Parent = billboardGui

    return billboardGui, textLabel
end

-- Main ESP Loop
RunService.Heartbeat:Connect(function()
    local workspace = game:GetService("Workspace")
    
    -- Check for legendary chests
    if espConfig.legendaryESP then
        local chests = workspace:FindFirstChild("Chests")
        if chests then
            for _, chest in pairs(chests:GetChildren()) do
                if chest.Name:lower():find("legendary") then
                    local billboard, textLabel = createESP(chest)
                    if billboard and textLabel then
                        textLabel.Text = "⭐ LEGENDARY"
                        textLabel.TextColor3 = Color3.fromRGB(255, 200, 0)
                    end
                end
            end
        end
    else
        -- Remove legendary ESP
        local chests = workspace:FindFirstChild("Chests")
        if chests then
            for _, chest in pairs(chests:GetChildren()) do
                if chest.Name:lower():find("legendary") then
                    local espLabel = chest:FindFirstChild("ESPLabel")
                    if espLabel then espLabel:Destroy() end
                end
            end
        end
    end
    
    -- Check for mythical chests
    if espConfig.mythicalESP then
        local chests = workspace:FindFirstChild("Chests")
        if chests then
            for _, chest in pairs(chests:GetChildren()) do
                if chest.Name:lower():find("mythical") then
                    local billboard, textLabel = createESP(chest)
                    if billboard and textLabel then
                        textLabel.Text = "✨ MYTHICAL"
                        textLabel.TextColor3 = Color3.fromRGB(255, 0, 255)
                    end
                end
            end
        end
    else
        -- Remove mythical ESP
        local chests = workspace:FindFirstChild("Chests")
        if chests then
            for _, chest in pairs(chests:GetChildren()) do
                if chest.Name:lower():find("mythical") then
                    local espLabel = chest:FindFirstChild("ESPLabel")
                    if espLabel then espLabel:Destroy() end
                end
            end
        end
    end
end)

print("✅ GPO Chest ESP Loaded! Press the X to close.")
